"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[297],{6297:function(e,t,n){n.r(t),n.d(t,{default:function(){return S}});var r=n(7437),u=n(2265);function o(e,t){return Object.freeze({...e,...t})}let l=(0,u.createContext)(null),i=l.Provider;function c(){let e=(0,u.useContext)(l);if(null==e)throw Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}var a=n(447),s=n.n(a);function f(){return(f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}let d=(0,u.forwardRef)(function({bounds:e,boundsOptions:t,center:n,children:r,className:o,id:l,placeholder:c,style:s,whenReady:d,zoom:p,...g},h){let[m]=(0,u.useState)({className:o,id:l,style:s}),[v,y]=(0,u.useState)(null);(0,u.useImperativeHandle)(h,()=>v?.map??null,[v]);let b=(0,u.useCallback)(r=>{if(null!==r&&null===v){let u=new a.Map(r,g);null!=n&&null!=p?u.setView(n,p):null!=e&&u.fitBounds(e,t),null!=d&&u.whenReady(d),y(Object.freeze({__version:1,map:u}))}},[]);(0,u.useEffect)(()=>()=>{v?.map.remove()},[v]);let w=v?u.createElement(i,{value:v},r):c??null;return u.createElement("div",f({},m,{ref:b}),w)});function p(e){return(0,u.forwardRef)(function(t,n){let{instance:r,context:o}=e(t).current;return(0,u.useImperativeHandle)(n,()=>r),null==t.children?null:u.createElement(i,{value:o},t.children)})}function g(e,t,n){return Object.freeze({instance:e,context:t,container:n})}function h(e,t){return null==t?function(t,n){let r=(0,u.useRef)();return r.current||(r.current=e(t,n)),r}:function(n,r){let o=(0,u.useRef)();o.current||(o.current=e(n,r));let l=(0,u.useRef)(n),{instance:i}=o.current;return(0,u.useEffect)(function(){l.current!==n&&(t(i,n,l.current),l.current=n)},[i,n,r]),o}}function m(e,t){let n=(0,u.useRef)();(0,u.useEffect)(function(){return null!=t&&e.instance.on(t),n.current=t,function(){null!=n.current&&e.instance.off(n.current),n.current=null}},[e,t])}function v(e,t){let n=e.pane??t.pane;return n?{...e,pane:n}:e}function y(e,t){(0,u.useEffect)(function(){let n=t.layerContainer??t.map;return n.addLayer(e.instance),function(){t.layerContainer?.removeLayer(e.instance),t.map.removeLayer(e.instance)}},[t,e])}function b(e){return function(t){let n=c(),r=e(v(t,n),n);return!function(e,t){let n=(0,u.useRef)(t);(0,u.useEffect)(function(){t!==n.current&&null!=e.attributionControl&&(null!=n.current&&e.attributionControl.removeAttribution(n.current),null!=t&&e.attributionControl.addAttribution(t)),n.current=t},[e,t])}(n.map,t.attribution),m(r.current,t.eventHandlers),y(r.current,n),r}}function w(e,t){let n=h(e,t);return p(function(e){let t=c(),r=n(v(e,t),t);return m(r.current,e.eventHandlers),y(r.current,t),function(e,t){let n=(0,u.useRef)();(0,u.useEffect)(function(){if(t.pathOptions!==n.current){let r=t.pathOptions??{};e.instance.setStyle(r),n.current=r}},[e,t])}(r.current,e),r})}n(4887);let C=function(e,t){let n=h(e,t),r=b(n);return(0,u.forwardRef)(function(e,t){let{instance:n}=r(e).current;return(0,u.useImperativeHandle)(t,()=>n),null})}(function({url:e,...t},n){let r=new a.TileLayer(e,v(t,n));return g(r,n)},function(e,t,n){!function(e,t,n){let{opacity:r,zIndex:u}=t;null!=r&&r!==n.opacity&&e.setOpacity(r),null!=u&&u!==n.zIndex&&e.setZIndex(u)}(e,t,n);let{url:r}=t;null!=r&&r!==n.url&&e.setUrl(r)}),O=function(e,t){let n=h(e,t),r=b(n);return p(r)}(function({position:e,...t},n){let r=new a.Marker(e,t);return g(r,o(n,{overlayContainer:r}))},function(e,t,n){t.position!==n.position&&e.setLatLng(t.position),null!=t.icon&&t.icon!==n.icon&&e.setIcon(t.icon),null!=t.zIndexOffset&&t.zIndexOffset!==n.zIndexOffset&&e.setZIndexOffset(t.zIndexOffset),null!=t.opacity&&t.opacity!==n.opacity&&e.setOpacity(t.opacity),null!=e.dragging&&t.draggable!==n.draggable&&(!0===t.draggable?e.dragging.enable():e.dragging.disable())}),x=w(function({children:e,...t},n){let r=new a.FeatureGroup([],t);return g(r,o(n,{layerContainer:r,overlayContainer:r}))}),E=w(function({positions:e,...t},n){let r=new a.Polyline(e,t);return g(r,o(n,{overlayContainer:r}))},function(e,t,n){t.positions!==n.positions&&e.setLatLngs(t.positions)});n(966);let j=s().icon({iconUrl:"https://cdn0.iconfinder.com/data/icons/small-n-flat/24/678111-map-marker-512.png",iconSize:[38,38]}),z=[[45.80850072738114,15.995897327348327],[45.8127078082012,15.965822569960194],[45.7957979116309,15.994046466360633],[45.83237666115715,15.976691289777696],[45.79241624579775,15.967861347682009],[45.790769337332456,15.962603669275117],[45.81308553008886,15.985218298487208],[45.79529545617052,15.966862987204482],[45.79208453798948,15.962314998140384],[45.79301777983297,15.96999731858222],[45.81346763078366,15.964666740763082],[45.802724329106006,16.003157316624034],[45.79477036242666,15.964455359288154],[45.795073239739295,15.994602926999647],[45.79990519258438,16.005837855444053],[45.81152737281019,15.997271997794591],[45.81013895081581,16.01665331155555],[45.7906664749969,15.962517897448157],[45.8031305900108,15.96356649572598],[45.79605451972534,15.96458844280814],[45.81469737831795,15.965038984815903],[45.79535766682832,15.967443600671858],[45.813597181124806,15.964735335581835],[45.796905204948686,15.966347649076924],[45.81274526135703,15.992717206633596],[45.809514113031256,15.96220512011199],[45.811162252465344,15.998046648877349],[45.81330322791377,15.997261164280657],[45.78081263901853,15.964095642314463],[45.80786913033796,16.00886497431401]],I=[45.800399,15.977568];function S(e){let{score:t}=e,[n,o]=(0,u.useState)([]),[l,i]=(0,u.useState)([]),[c,a]=(0,u.useState)(0),[s,f]=(0,u.useState)(!1),[p,g]=(0,u.useState)(!0),h=async()=>{let e;if(void 0==l)return;let r=[];l.length>1?(r.push(l[l.length-2]),r.push(l[l.length-1])):r.push(l[0]);for(let t=0;t<r.length;t++)0==t?e=r[t][0]+","+r[t][1]:e+=";"+r[t][0]+","+r[t][1];let u=await fetch("http://router.project-osrm.org/route/v1/driving/"+e+"?overview=full&geometries=geojson"),i=await u.json(),s=[];for(let e=0;e<i.routes[0].geometry.coordinates.length;e++)s.push([i.routes[0].geometry.coordinates[e][1],i.routes[0].geometry.coordinates[e][0]]);let f=0;for(let e=0;e<i.routes[0].legs.length;e++)f+=i.routes[0].legs[e].distance;a(c+f),o([...n,s]),t.gameFinished(c+f)},m=e=>{if(""==e||s||p)return;let t=[e[1],e[0]];void 0!=l&&l.length>1&&29==l.length&&JSON.stringify(l[0])==JSON.stringify(t)?(i([...l,t]),f(!0),console.log("gameEnd")):l.length>0?i([...l,t]):i([t])};return(0,u.useEffect)(()=>{l.length>1&&h()},[l]),(0,u.useEffect)(()=>{t.remove&&(o([]),f(!1),i([]),a(0))},[t.remove]),(0,u.useEffect)(()=>{""!=t.user&&g(!1)},[t.user]),(0,r.jsxs)(d,{center:I,zoomControl:!1,doubleClickZoom:!1,zoom:14,scrollWheelZoom:!0,style:{height:"100%",width:"100%"},children:[(0,r.jsx)(C,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png?markers"}),z.map(e=>(0,r.jsx)(O,{position:e,icon:j,eventHandlers:{click:()=>{m(e)}}},e[0])),(0,r.jsx)(x,{children:(0,r.jsx)(E,{pathOptions:{color:"red"},positions:n})})]})}}}]);